{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "# HDInsight Hadoop Insights"
      },
      "name": "text - 0"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "crossComponentResources": [
          "{Subscription}"
        ],
        "parameters": [
          {
            "id": "a1ed4849-d460-42bf-ba5e-632d97451a00",
            "version": "KqlParameterItem/1.0",
            "name": "Subscription",
            "type": 6,
            "description": "Subscription of Log Analytics Workspace containing your cluster's data",
            "isRequired": true,
            "value": "/subscriptions/c36fd9e7-e5b1-4d3e-bb85-2e538040258b",
            "typeSettings": {
              "additionalResourceOptions": [],
              "includeAll": false
            },
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "7df9f4cd-0e8f-4f76-9198-3cf5d0d66e31",
            "version": "KqlParameterItem/1.0",
            "name": "LogAnalyticsWorkspaceName",
            "type": 5,
            "description": "Name of Log Analytics workspace containing your cluster's data",
            "isRequired": true,
            "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| project id",
            "crossComponentResources": [
              "{Subscription}"
            ],
            "value": "/subscriptions/c36fd9e7-e5b1-4d3e-bb85-2e538040258b/resourceGroups/becohen-canary/providers/Microsoft.OperationalInsights/workspaces/becohen-canary2",
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          }
        ],
        "style": "pills",
        "queryType": 1,
        "resourceType": "microsoft.resourcegraph/resources"
      },
      "name": "Log Analytic Workspace Parameters"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "804c95b2-ab8e-42c8-93e7-f14cb8701d7b",
            "version": "KqlParameterItem/1.0",
            "name": "Cluster",
            "type": 5,
            "isRequired": true,
            "query": "where type =~ 'microsoft.hdinsight/clusters'| order by name asc| extend Rank = row_number()| project value = id, label = id, selected = Rank <= 5",
            "crossComponentResources": [
              "{Subscription}"
            ],
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "509ede8c-c26f-44ab-a366-bc3147d208b2",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "type": 4,
            "isRequired": true,
            "value": {
              "durationMs": 43200000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 300000
                },
                {
                  "durationMs": 900000
                },
                {
                  "durationMs": 1800000
                },
                {
                  "durationMs": 3600000
                },
                {
                  "durationMs": 14400000
                },
                {
                  "durationMs": 43200000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2419200000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ],
              "allowCustom": true
            },
            "timeContext": {
              "durationMs": 86400000
            }
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.resourcegraph/resources"
      },
      "name": "Cluster Parameters"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "965b7c1f-4adb-4cd8-8288-0765f301fba2",
            "cellValue": "tab",
            "linkTarget": "parameter",
            "linkLabel": "Hive",
            "subTarget": "Hive",
            "style": "link"
          },
          {
            "id": "1e45acd0-e147-4e26-859f-f6fea258b038",
            "cellValue": "tab",
            "linkTarget": "parameter",
            "linkLabel": "YARN",
            "subTarget": "Yarn",
            "style": "link"
          },
          {
            "id": "361f2b01-618e-4599-9a7e-fea76c27c7b5",
            "cellValue": "tab",
            "linkTarget": "parameter",
            "linkLabel": "System Metrics",
            "subTarget": "SystemMetrics",
            "style": "link"
          },
          {
            "id": "721c28b9-66eb-454d-ba78-21cd0d7c3ace",
            "cellValue": "tab",
            "linkTarget": "parameter",
            "linkLabel": "Component Logs",
            "subTarget": "ComponentLogs",
            "style": "link"
          }
        ]
      },
      "name": "links - 9"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Component Logs",
        "items": [
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "cellValue": "log_tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Hadoop And Yarn",
                  "subTarget": "HadoopAndYarn",
                  "preText": "HadoopAndYarn",
                  "style": "link"
                },
                {
                  "cellValue": "log_tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Hive And LLAP",
                  "subTarget": "HiveAndLLAP",
                  "style": "link"
                },
                {
                  "cellValue": "log_tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Oozie",
                  "subTarget": "Oozie",
                  "style": "link"
                }
              ]
            },
            "name": "links - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "parameters": [
                      {
                        "id": "d209cf7b-ddb7-4ec2-9e8b-e5772d397d5d",
                        "version": "KqlParameterItem/1.0",
                        "name": "HadoopAndYarnLogType",
                        "type": 2,
                        "description": "Log Types that will show in the table",
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "HDInsightHadoopAndYarnLogs\r\n| where TimeGenerated {TimeRange}\r\n| distinct LogType",
                        "crossComponentResources": [
                          "{LogAnalyticsWorkspaceName}"
                        ],
                        "value": [
                          "TimelineServer",
                          "NodeManager"
                        ],
                        "typeSettings": {
                          "additionalResourceOptions": []
                        },
                        "timeContext": {
                          "durationMs": 43200000
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "label": "LogType"
                      },
                      {
                        "id": "e3973cc7-67a7-46e3-b0e5-b6b5dd0b392e",
                        "version": "KqlParameterItem/1.0",
                        "name": "HadoopAndYarnLogLevel",
                        "type": 2,
                        "description": "Log Level of Logs returned in queries",
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "HDInsightHadoopAndYarnLogs\r\n| where TimeGenerated {TimeRange}\r\n| distinct LogLevel",
                        "crossComponentResources": [
                          "{LogAnalyticsWorkspaceName}"
                        ],
                        "value": [
                          "ERROR"
                        ],
                        "typeSettings": {
                          "additionalResourceOptions": []
                        },
                        "timeContext": {
                          "durationMs": 43200000
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces",
                        "label": "LogLevel"
                      },
                      {
                        "id": "686bc2e9-cceb-45c6-86b5-de58babe71f5",
                        "version": "KqlParameterItem/1.0",
                        "name": "HadoopAndYarnNumberofLogs",
                        "type": 1,
                        "description": "Number of Logs that will be returned in query",
                        "isRequired": true,
                        "value": "20",
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "label": "NumberofLogs"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "parameters - 6"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnLogs\r\n| where ClusterName == '{Cluster:label}'\r\n| where LogType in ({HadoopAndYarnLogType}) and LogLevel in ({HadoopAndYarnLogLevel})\r\n| take {HadoopAndYarnNumberofLogs}\r\n| project TimeGenerated, LogType, LogLevel ,Message\r\n|order by TimeGenerated desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Hadoop and Yarn Logs",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Message",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "230.1429ch"
                          }
                        }
                      ]
                    }
                  },
                  "name": "Hadoop and Yarn Logs"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnLogs\r\n| where ClusterName == '{Cluster:label}'\r\n| where LogType in ({HadoopAndYarnLogType}) and LogLevel in ({HadoopAndYarnLogLevel})\r\n| summarize count() by LogLevel, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| take 10000",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Log Level Counts",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart"
                  },
                  "name": "Log Level Counts"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "log_tab",
              "comparison": "isEqualTo",
              "value": "HadoopAndYarn"
            },
            "name": "Hadoop And Yarn Logs"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "parameters": [
                      {
                        "id": "d209cf7b-ddb7-4ec2-9e8b-e5772d397d5d",
                        "version": "KqlParameterItem/1.0",
                        "name": "HiveLogType",
                        "label": "LogType",
                        "type": 2,
                        "description": "Log Types that will show in the table",
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "HDInsightHiveAndLLAPLogs\r\n| where TimeGenerated {TimeRange}\r\n| distinct LogType",
                        "crossComponentResources": [
                          "{LogAnalyticsWorkspaceName}"
                        ],
                        "value": [
                          "HiveServer2Log"
                        ],
                        "typeSettings": {
                          "additionalResourceOptions": []
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      },
                      {
                        "id": "e3973cc7-67a7-46e3-b0e5-b6b5dd0b392e",
                        "version": "KqlParameterItem/1.0",
                        "name": "HiveLogLevel",
                        "label": "LogLevel",
                        "type": 2,
                        "description": "Log Level of Logs returned in queries",
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "HDInsightHiveAndLLAPLogs\r\n| where TimeGenerated {TimeRange}\r\n| distinct LogLevel",
                        "crossComponentResources": [
                          "{LogAnalyticsWorkspaceName}"
                        ],
                        "value": [
                          "INFO"
                        ],
                        "typeSettings": {
                          "additionalResourceOptions": []
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      },
                      {
                        "id": "686bc2e9-cceb-45c6-86b5-de58babe71f5",
                        "version": "KqlParameterItem/1.0",
                        "name": "HiveNumberofLogs",
                        "type": 1,
                        "description": "Number of Logs that will be returned in query",
                        "isRequired": true,
                        "value": "20",
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "TimeRange",
                        "label": "NumberofLogs"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "parameters - 6 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHiveAndLLAPLogs\r\n| where ClusterName == '{Cluster:label}'\r\n| where LogType in ({HiveLogType}) and LogLevel in ({HiveLogLevel})\r\n| take {HiveNumberofLogs}\r\n| project TimeGenerated, LogType, LogLevel ,Message\r\n|order by TimeGenerated desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Hive and LLAP Logs",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Message",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "230.1429ch"
                          }
                        }
                      ]
                    }
                  },
                  "name": "Hive and LLAP Logs"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHiveAndLLAPLogs\r\n| where ClusterName == '{Cluster:label}'\r\n| where LogType in ({HiveLogType}) and LogLevel in ({HiveLogLevel})\r\n| summarize count() by LogLevel, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| take 10000",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Log Level Counts",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart"
                  },
                  "name": "Log Level Counts - Copy"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "log_tab",
              "comparison": "isEqualTo",
              "value": "HiveAndLLAP"
            },
            "name": "Hive Logs"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Oozie Logs",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "d209cf7b-ddb7-4ec2-9e8b-e5772d397d5d",
                        "version": "KqlParameterItem/1.0",
                        "name": "OozieLogType",
                        "label": "LogType",
                        "type": 2,
                        "description": "Log Types that will show in the table",
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "HDInsightOozieLogs\r\n| where TimeGenerated {TimeRange}\r\n| distinct LogType",
                        "crossComponentResources": [
                          "{LogAnalyticsWorkspaceName}"
                        ],
                        "value": [],
                        "typeSettings": {
                          "additionalResourceOptions": []
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      },
                      {
                        "id": "e3973cc7-67a7-46e3-b0e5-b6b5dd0b392e",
                        "version": "KqlParameterItem/1.0",
                        "name": "OozieLogLevel",
                        "label": "LogLevel",
                        "type": 2,
                        "description": "Log Level of Logs returned in queries",
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "HDInsightOozieLogs\r\n| where TimeGenerated {TimeRange}\r\n| distinct LogLevel",
                        "crossComponentResources": [
                          "{LogAnalyticsWorkspaceName}"
                        ],
                        "value": [],
                        "typeSettings": {
                          "additionalResourceOptions": []
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "timeContextFromParameter": "TimeRange",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      },
                      {
                        "id": "686bc2e9-cceb-45c6-86b5-de58babe71f5",
                        "version": "KqlParameterItem/1.0",
                        "name": "OozieNumberofLogs",
                        "label": "NumberofLogs",
                        "type": 1,
                        "description": "Number of Logs that will be returned in query",
                        "isRequired": true,
                        "value": "20",
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "timeContextFromParameter": "TimeRange"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "parameters - 6 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightOozieLogs\r\n| where ClusterName == '{Cluster:label}'\r\n| where LogType in ({OozieLogType}) and LogLevel in ({OozieLogLevel})\r\n| take {OozieNumberofLogs}\r\n| project TimeGenerated, LogType, LogLevel ,Message\r\n|order by TimeGenerated desc",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Oozie Logs",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Message",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "230.1429ch"
                          }
                        }
                      ]
                    }
                  },
                  "name": "Oozie Logs"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightOozieLogs\r\n| where ClusterName == '{Cluster:label}'\r\n| where LogType in ({OozieLogType}) and LogLevel in ({OozieLogLevel})\r\n| summarize count() by LogLevel, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| take 10000",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Log Level Counts",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart"
                  },
                  "name": "Log Level Counts - Copy"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "log_tab",
              "comparison": "isEqualTo",
              "value": "Oozie"
            },
            "name": "Oozie Logs"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Cluster",
          "comparison": "isNotEqualTo"
        },
        {
          "parameterName": "tab",
          "comparison": "isEqualTo",
          "value": "ComponentLogs"
        }
      ],
      "name": "Component Logs"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "System Metrics",
        "items": [
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "cellValue": "metrics_tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Disk",
                  "subTarget": "Disk",
                  "preText": "Disk",
                  "style": "link"
                },
                {
                  "cellValue": "metrics_tab",
                  "linkTarget": "parameter",
                  "linkLabel": "CPU",
                  "subTarget": "CPU",
                  "style": "link"
                },
                {
                  "cellValue": "metrics_tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Memory",
                  "subTarget": "Memory",
                  "style": "link"
                },
                {
                  "cellValue": "metrics_tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Load",
                  "subTarget": "Load",
                  "style": "link"
                }
              ]
            },
            "name": "links - 4"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Disk",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightAmbariSystemMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| extend NodeType = substring(HostName,0,2)\r\n| summarize DiskPercentUsed = (1 - sum(DiskFree)/sum(DiskTotal))*100 by NodeType, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| take 10000",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Disk Usage Percentage by Node Type",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "DiskPercentFree",
                          "formatter": 0,
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "percent",
                              "useGrouping": false
                            }
                          }
                        }
                      ]
                    },
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 1,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumSignificantDigits": 3
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 0"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightAmbariSystemMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| summarize  DiskPercentUsed = (1 - sum(DiskFree)/sum(DiskTotal))*100, DiskUsedGB=avg(DiskTotal - DiskFree) by HostName, bin(TimeGenerated, {TimeRange:grain})\r\n| order by TimeGenerated, HostName desc\r\n| summarize arg_max(TimeGenerated, *) by HostName\r\n| sort by DiskPercentUsed desc\r\n",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Disk Used Percentage by Host",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "DiskPercentUsed",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "red"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal",
                              "useGrouping": false,
                              "maximumSignificantDigits": 3
                            }
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "50",
                  "name": "Disk Usage Per Host"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightAmbariSystemMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where TimeGenerated {TimeRange}\r\n| make-series avg(ReadCount) default=double(null) on TimeGenerated in range({TimeRange:start} , {TimeRange:end}, {TimeRange:grain}) by HostName\r\n| extend filled_avg_metric_value = series_fill_forward(avg_ReadCount) \r\n| mv-expand TimeGenerated to typeof(datetime), filled_avg_metric_value to typeof(int)\r\n| order by HostName desc,TimeGenerated asc \r\n| extend RateOfChange = iif(prev(HostName) == HostName, (filled_avg_metric_value - prev(filled_avg_metric_value, 1))/60.0, 0.0)\r\n| project TimeGenerated, HostName, RateOfChange",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Disk Read Count Per Second by Host",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart"
                  },
                  "customWidth": "50",
                  "showPin": true,
                  "name": "Disk Read Count Per Second"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightAmbariSystemMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where TimeGenerated {TimeRange}\r\n| make-series avg(WriteCount) default=double(null) on TimeGenerated in range({TimeRange:start} , {TimeRange:end}, {TimeRange:grain}) by HostName\r\n| extend filled_avg_metric_value = series_fill_forward(avg_WriteCount) \r\n| mv-expand TimeGenerated to typeof(datetime), filled_avg_metric_value to typeof(int)\r\n| order by HostName desc,TimeGenerated asc \r\n| extend RateOfChange = iif(prev(HostName) == HostName, (filled_avg_metric_value - prev(filled_avg_metric_value, 1))/60.0, 0.0)\r\n| project TimeGenerated, HostName, RateOfChange",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Disk Write Count Per Second by Host",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart"
                  },
                  "customWidth": "50",
                  "showPin": true,
                  "name": "Disk Write Count Per Second by Host"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Cluster",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "metrics_tab",
                "comparison": "isEqualTo",
                "value": "Disk"
              }
            ],
            "name": "Disk"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "CPU Metrics",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightAmbariSystemMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| extend NodeType = substring(HostName,0,2)\r\n| summarize CPUUsagePercentage = avg(100 - CpuIdle) by NodeType, bin(TimeGenerated, {TimeRange:grain})\r\n",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "CPU Usage Percentage by Node Type",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 1,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumSignificantDigits": 3
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "CPU Usage Percentage by Node Type"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightAmbariSystemMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| summarize CPUUsagePercentage = avg(100 - CpuIdle) by HostName, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| summarize arg_max(TimeGenerated, *) by HostName\r\n| sort by CPUUsagePercentage desc",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "CPU Usage Percentage by Host",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "CPUUsagePercentage",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "red"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal",
                              "useGrouping": false,
                              "maximumSignificantDigits": 3
                            }
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "50",
                  "showPin": true,
                  "name": "CPU Usage Percentage by Host"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "metrics_tab",
              "comparison": "isEqualTo",
              "value": "CPU"
            },
            "name": "CPU"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Memory Metrics",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightAmbariSystemMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| extend NodeType = substring(HostName,0,2)\r\n| summarize FreeMemory = avg(FreeMemory) by NodeType, bin(TimeGenerated, {TimeRange:grain})\r\n",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Free Memory in Bytes by Node Type",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 2,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "showPin": true,
                  "name": "Free Memory in Bytes by Node Type"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightAmbariSystemMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| summarize MemoryUsedPercentage = (1 - sum(FreeMemory)/sum(TotalMemory))*100 by  HostName, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| summarize arg_max(TimeGenerated, *) by HostName\r\n| sort by MemoryUsedPercentage desc",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Memory Usage Percentage by Host",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "MemoryUsedPercentage",
                          "formatter": 8,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "red"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal",
                              "useGrouping": false,
                              "maximumSignificantDigits": 3
                            }
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "50",
                  "showPin": true,
                  "name": "Memory Usage Percentage by Host"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "metrics_tab",
              "comparison": "isEqualTo",
              "value": "Memory"
            },
            "name": "Memory"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Load Metrics",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightAmbariSystemMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| extend NodeType = substring(HostName,0,2)\r\n| summarize OneMinuteLoad = avg(OneMinuteLoad) by NodeType, bin(TimeGenerated, {TimeRange:grain})",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "One Minute Load by Node Type",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart"
                  },
                  "customWidth": "50",
                  "name": "query - 0"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightAmbariSystemMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| summarize OneMinuteLoad = avg(OneMinuteLoad) by HostName, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| summarize arg_max(TimeGenerated, *) by HostName\r\n| sort by OneMinuteLoad desc",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "One Minute Load by Node",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "OneMinuteLoad",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "red"
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 0 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightAmbariSystemMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| extend NodeType = substring(HostName,0,2)\r\n| summarize FiveMinuteLoad = avg(FiveMinuteLoad) by NodeType, bin(TimeGenerated, {TimeRange:grain})",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Five Minute Load by Node Type",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart"
                  },
                  "customWidth": "50",
                  "name": "query - 0 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightAmbariSystemMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| summarize FiveMinuteLoad = avg(FiveMinuteLoad) by HostName, bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| summarize arg_max(TimeGenerated, *) by HostName\r\n| sort by FiveMinuteLoad desc",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Five Minute Load by Node",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "FiveMinuteLoad",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "red"
                          }
                        }
                      ]
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 0 - Copy - Copy"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "metrics_tab",
              "comparison": "isEqualTo",
              "value": "Load"
            },
            "name": "Load"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Cluster",
          "comparison": "isNotEqualTo"
        },
        {
          "parameterName": "tab",
          "comparison": "isEqualTo",
          "value": "SystemMetrics"
        }
      ],
      "name": "System Metrics"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "id": "a04ba5c0-6c78-4a99-a7ca-78ddbd3f57c0",
                  "cellValue": "yarn_tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Overview",
                  "subTarget": "Overview",
                  "style": "link"
                },
                {
                  "id": "ccae0674-d61e-46ee-904d-14a6b58dc883",
                  "cellValue": "yarn_tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Apps",
                  "subTarget": "Apps",
                  "preText": "",
                  "style": "link"
                },
                {
                  "id": "3a013ca8-11d2-4ca8-af6d-b15b80d7a042",
                  "cellValue": "yarn_tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Node Managers",
                  "subTarget": "NodeManagers",
                  "style": "link"
                },
                {
                  "id": "e47483ee-fb27-459d-abcb-ace7081a7c66",
                  "cellValue": "yarn_tab",
                  "linkTarget": "parameter",
                  "linkLabel": "JVM",
                  "subTarget": "JVM",
                  "style": "link"
                },
                {
                  "id": "e9e32c59-5d4c-4eed-8dd0-bc8b0dcc3d91",
                  "cellValue": "yarn_tab",
                  "linkTarget": "parameter",
                  "linkLabel": "Timeline Server",
                  "subTarget": "TimelineServer",
                  "style": "link"
                }
              ]
            },
            "name": "links - 0"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Yarn App Metrics",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName contains \"Apps\" \r\n| summarize arg_max(TimeGenerated,*) by MetricNamespace, MetricName\r\n| summarize sum(MetricValue) by MetricName, bin(TimeGenerated,{TimeRange:grain})",
                    "size": 0,
                    "aggregation": 5,
                    "title": "App States",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart"
                  },
                  "name": "App States"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"AMLaunchDelayAvgTime\"\r\n| summarize arg_max(TimeGenerated,*) by MetricNamespace, MetricName\r\n| summarize avg(MetricValue) by MetricName, bin(TimeGenerated,{TimeRange:grain})",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Avg AM Launch Delay Time in MS",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 23,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "Avg AM Launch Delay Time in MS"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"AMRegisterDelayAvgTime\"\r\n| summarize arg_max(TimeGenerated,*) by MetricNamespace, MetricName\r\n| summarize sum(MetricValue) by MetricName, bin(TimeGenerated,{TimeRange:grain})",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Avg AM Register Delay Time in MS",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 23,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "Avg AM Register Delay Time in MS"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Cluster",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "yarn_tab",
                "comparison": "isEqualTo",
                "value": "Apps"
              }
            ],
            "name": "Apps"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Node Manager",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "c78d5501-b3ce-4f09-aa35-97a49527cf77",
                        "cellValue": "nm_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Containers",
                        "subTarget": "Containers",
                        "style": "link"
                      },
                      {
                        "id": "f2078e19-2d79-4ab5-857c-ebc8c8495a53",
                        "cellValue": "nm_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Memory",
                        "subTarget": "Memory",
                        "style": "link"
                      },
                      {
                        "id": "01bcba1f-b799-4819-a3ff-4b8556c63795",
                        "cellValue": "nm_tab",
                        "linkTarget": "parameter",
                        "linkLabel": "Disk",
                        "subTarget": "Disk",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 1"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Node Manager Containers",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains \"NodeManager\" and (MetricName == \"ContainersRunning\" or MetricName == \"ContainersCompleted\" or MetricName == \"ContainersKilled\" or MetricName == \"ContainersFailed\")\r\n| summarize max(MetricValue) by MetricName, bin(TimeGenerated,{TimeRange:grain})",
                          "size": 0,
                          "aggregation": 5,
                          "title": "Container States",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{LogAnalyticsWorkspaceName}"
                          ],
                          "visualization": "linechart"
                        },
                        "name": "Container States"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"ContainerLaunchDurationAvgTime\"\r\n| take 10000\r\n| project ClusterName, TimeGenerated, MetricValue",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Average Container Launch Delay in MS",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{LogAnalyticsWorkspaceName}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            },
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 23,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "name": "query - 2"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "nm_tab",
                    "comparison": "isEqualTo",
                    "value": "Containers"
                  },
                  "name": "Containers"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Node Manager Memory",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains \"NodeManager\" and MetricName == \"AvailableGB\"\r\n| take 10000\r\n| project ClusterName, TimeGenerated, MetricValue",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Memory Available",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{LogAnalyticsWorkspaceName}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 5,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains \"NodeManager\" and MetricName == \"AllocatedGB\"\r\n| take 10000\r\n| project ClusterName, TimeGenerated, MetricValue",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Memory Allocated",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{LogAnalyticsWorkspaceName}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 5,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 0 - Copy"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "nm_tab",
                    "comparison": "isEqualTo",
                    "value": "Memory"
                  },
                  "name": "Node Manager Memory"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Node Manager Disk",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains \"NodeManager\" and MetricName == \"GoodLogDirsDiskUtilizationPerc\"\r\n| take 10000\r\n| project ClusterName, TimeGenerated, MetricValue",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Disk Utilization for Good Log Dirs",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{LogAnalyticsWorkspaceName}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains \"NodeManager\" and MetricName == \"GoodLocalDirsDiskUtilizationPerc\"\r\n| take 10000\r\n| project ClusterName, TimeGenerated, MetricValue",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Disk Utilization for Good Local Dirs",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{LogAnalyticsWorkspaceName}"
                          ],
                          "visualization": "linechart",
                          "chartSettings": {
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 1,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "50",
                        "name": "query - 0 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains \"NodeManager\" and MetricName == \"BadLogDirs\"\r\n| take 10000\r\n| project ClusterName, TimeGenerated, MetricValue",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Num Bad Log Dirs",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{LogAnalyticsWorkspaceName}"
                          ],
                          "visualization": "linechart"
                        },
                        "customWidth": "50",
                        "name": "query - 0 - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains \"NodeManager\" and MetricName == \"BadLocalDirs\"\r\n| take 10000\r\n| project ClusterName, TimeGenerated, MetricValue",
                          "size": 0,
                          "aggregation": 5,
                          "showAnalytics": true,
                          "title": "Num Bad Local Dirs",
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeRange",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{LogAnalyticsWorkspaceName}"
                          ],
                          "visualization": "linechart"
                        },
                        "customWidth": "50",
                        "name": "query - 0 - Copy - Copy - Copy"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "nm_tab",
                    "comparison": "isEqualTo",
                    "value": "Disk"
                  },
                  "name": "Node Manager Disk"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Cluster",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "yarn_tab",
                "comparison": "isEqualTo",
                "value": "NodeManagers"
              }
            ],
            "name": "Node Manager"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "YARN Cluster Overview",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"NumActiveNMs\"\r\n| order by TimeGenerated desc\r\n| take 1\r\n",
                    "size": 4,
                    "showAnalytics": true,
                    "title": "Active Nodes",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MetricValue",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "25",
                  "name": "query - 0",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"AvailableMB\"\r\n| order by TimeGenerated desc\r\n| take 1\r\n",
                    "size": 4,
                    "showAnalytics": true,
                    "title": "Cluster Memory Available",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MetricValue",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 4,
                          "options": {
                            "style": "decimal",
                            "useGrouping": false,
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "25",
                  "name": "Cluster Memory Available",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"AppsRunning\"\r\n| order by TimeGenerated desc\r\n| take 1\r\n",
                    "size": 4,
                    "showAnalytics": true,
                    "title": "Running Apps",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MetricValue",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 0,
                          "options": {
                            "style": "decimal",
                            "useGrouping": false,
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "25",
                  "name": "Running Apps",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"MemHeapUsedM\"\r\n| order by TimeGenerated desc\r\n| take 1\r\n",
                    "size": 4,
                    "showAnalytics": true,
                    "title": "Resource Manager Heap Usage",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MetricValue",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 4,
                          "options": {
                            "style": "decimal",
                            "useGrouping": false,
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "25",
                  "name": "Resource Manager Heap",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"NumActiveNMs\" or MetricName == \"NumUnhealthyNMs\" or MetricName == \"NumLostNMs\" or MetricName == \"NumDecommisionedNMs\" or MetricName == \"NumRebootedNMs\" \r\n| summarize avg(MetricValue) by MetricName, bin(TimeGenerated,{TimeRange:grain})",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Node States",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart"
                  },
                  "customWidth": "50",
                  "name": "query - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"AppsRunning\" or MetricName == \"AppsPending\" or MetricName == \"AppsFailed\" or MetricName == \"AppsComplete\" or MetricName == \"AppsSubmitted\" \r\n| summarize arg_max(TimeGenerated,*) by MetricNamespace, MetricName\r\n| summarize sum(MetricValue) by MetricName, bin(TimeGenerated,{TimeRange:grain})",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "App States",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart"
                  },
                  "customWidth": "50",
                  "name": "query - 4 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"AvailableMB\"// and MetricNamespace == \"Hadoop:service=ResourceManager,name=QueueMetrics,q0=root\"\r\n| summarize MetricValue=max(MetricValue) by MetricNamespace, bin(TimeGenerated, {TimeRange:grain})\r\n| extend MetricNamespace = substring(MetricNamespace, 36)\r\n| order by TimeGenerated desc\r\n| take 10000\r\n| project MetricNamespace, TimeGenerated, MetricValue\r\n",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Cluster Memory Available",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart",
                    "tileSettings": {
                      "titleContent": {
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MetricValue",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 4,
                          "options": {
                            "style": "decimal",
                            "useGrouping": false,
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "showBorder": false
                    },
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 4,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      }
                    }
                  },
                  "name": "Cluster Memory Available - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "yarn_tab",
              "comparison": "isEqualTo",
              "value": "Overview"
            },
            "name": "Overview"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "YARN JVM",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "aa7b52fb-0130-4b7f-a34a-a212b473d176",
                        "version": "KqlParameterItem/1.0",
                        "name": "Component",
                        "type": 2,
                        "description": "Component to get JVM metrics for",
                        "isRequired": true,
                        "value": "ResourceManager",
                        "typeSettings": {
                          "additionalResourceOptions": []
                        },
                        "jsonData": "[\r\n    { \"value\":\"NodeManager\", \"label\":\"NodeManager\" },\r\n    { \"value\":\"ResourceManager\", \"label\":\"ResourceManager\" },\r\n    { \"value\":\"ApplicationHistoryServer\", \"label\":\"TimelineServer\"},\r\n    { \"value\":\"JobHistoryServer\", \"label\":\"JobHistoryServer\"}\r\n]",
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "parameters - 1"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains '{Component}' and MetricName == \"MemHeapUsedM\" \r\n| summarize avg(MetricValue) by HostName,bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| take 10000\r\n",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "JVM Heap Usage in MB",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 4,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 0"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains '{Component}' and MetricName == \"MemNonHeapUsedM\" \r\n| summarize avg(MetricValue) by HostName,bin(TimeGenerated, {TimeRange:grain})\r\n|order by TimeGenerated desc\r\n| take 10000\r\n",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "JVM Non-Heap Usage in MB",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 4,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 0 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}' and MetricNamespace contains '{Component}'\r\n| where MetricName == \"GcCount\"\r\n| where TimeGenerated {TimeRange}\r\n| make-series avg(MetricValue) default=double(null) on TimeGenerated in range({TimeRange:start} , {TimeRange:end}, {TimeRange:grain}) by HostName\r\n| extend filled_avg_metric_value = series_fill_forward(avg_MetricValue) \r\n| mv-expand TimeGenerated to typeof(datetime), filled_avg_metric_value to typeof(int)\r\n| order by HostName desc,TimeGenerated asc \r\n| extend RateOfChange = iif(prev(HostName) == HostName, (filled_avg_metric_value - prev(filled_avg_metric_value, 1))/60.0, 0.0)\r\n| project TimeGenerated, HostName, RateOfChange\r\n",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Garbage Collections By Host",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 31,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 5"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}' and MetricNamespace contains \"{Component}\" and MetricName contains \"Gc\"\r\n| evaluate pivot(MetricName, avg(MetricValue),TimeGenerated, ClusterName, HostName)\r\n| where TimeGenerated {TimeRange}\r\n| make-series avg(GcCount) default=double(null), avg(GcTimeMillis) default=double(null) on TimeGenerated in range({TimeRange:start} , {TimeRange:end}, {TimeRange:grain}) by HostName\r\n| extend filled_avg_count_value = series_fill_forward(avg_GcCount), filled_avg_time_value = series_fill_forward(avg_GcTimeMillis)\r\n| mv-expand TimeGenerated to typeof(datetime), filled_avg_count_value to typeof(double), filled_avg_time_value to typeof(double)\r\n| order by HostName desc,TimeGenerated asc \r\n| extend RateOfChange = iif(prev(HostName) == HostName, (filled_avg_time_value - prev(filled_avg_time_value, 1))/(filled_avg_count_value - prev(filled_avg_count_value, 1)) , 0.0)\r\n| extend RateOfChangeNoNan = iif(isnan(RateOfChange), 0.0, RateOfChange)\r\n| project TimeGenerated, HostName, RateOfChangeNoNan\r\n\r\n\r\n",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Mean Time Per Collection in MS",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 23,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 4"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "yarn_tab",
              "comparison": "isEqualTo",
              "value": "JVM"
            },
            "name": "YARN JVM"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "YARN Timeline Server",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"GetEntitiesTotal\"\r\n| project ClusterName, TimeGenerated, MetricValue",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Timeline Entity Data Reads",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart"
                  },
                  "customWidth": "50",
                  "name": "Timeline Entity Data Reads"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"GetEntitiesTimeAvgTime\"\r\n| project ClusterName, TimeGenerated, MetricValue",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Average Timeline Entity Data Read Time",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 23,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "Average Timeline Entity Data Read Time"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"PostEntitiesTotal\"\r\n| project ClusterName, TimeGenerated, MetricValue",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Timeline Entity Data Writes",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart"
                  },
                  "customWidth": "50",
                  "name": "Timeline Entity Data Writes"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "HDInsightHadoopAndYarnMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"PostEntitiesTimeAvgTime\"\r\n| project ClusterName, TimeGenerated, MetricValue",
                    "size": 0,
                    "aggregation": 5,
                    "showAnalytics": true,
                    "title": "Average Timeline Entity Data Write Time",
                    "timeContext": {
                      "durationMs": 43200000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{LogAnalyticsWorkspaceName}"
                    ],
                    "visualization": "linechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 23,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "Average Timeline Entity Data Write Time"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "yarn_tab",
              "comparison": "isEqualTo",
              "value": "TimelineServer"
            },
            "name": "YARN Timeline Server"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "tab",
        "comparison": "isEqualTo",
        "value": "Yarn"
      },
      "name": "Yarn"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "HDInsightHiveAndLLAPMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"NumActiveSources\"\r\n|project ClusterName,MetricName, TimeGenerated, MetricValue\r\n| order by TimeGenerated desc\r\n| take 1",
              "size": 4,
              "showAnalytics": true,
              "timeContext": {
                "durationMs": 43200000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{LogAnalyticsWorkspaceName}"
              ],
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "MetricName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "MetricValue",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "20",
            "name": "query - 0"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "HDInsightHiveAndLLAPMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"NumActiveSinks\"\r\n|project ClusterName,MetricName, TimeGenerated, MetricValue\r\n| order by TimeGenerated desc\r\n| take 1",
              "size": 4,
              "showAnalytics": true,
              "timeContext": {
                "durationMs": 43200000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{LogAnalyticsWorkspaceName}"
              ],
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "MetricName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "MetricValue",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "20",
            "name": "query - 0 - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "HDInsightHiveAndLLAPMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"Sink_timelineAvgTime\"\r\n|project ClusterName,MetricName, TimeGenerated, MetricValue\r\n| order by TimeGenerated desc\r\n| take 1",
              "size": 4,
              "showAnalytics": true,
              "timeContext": {
                "durationMs": 43200000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{LogAnalyticsWorkspaceName}"
              ],
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "MetricName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "MetricValue",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 23,
                    "options": {
                      "style": "decimal",
                      "useGrouping": false,
                      "maximumFractionDigits": 2,
                      "maximumSignificantDigits": 3
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "20",
            "name": "query - 0 - Copy - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "HDInsightHiveAndLLAPMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"PublishAvgTime\"\r\n|project ClusterName,MetricName, TimeGenerated, MetricValue\r\n| order by TimeGenerated desc\r\n| take 1",
              "size": 4,
              "showAnalytics": true,
              "timeContext": {
                "durationMs": 43200000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{LogAnalyticsWorkspaceName}"
              ],
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "MetricName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "MetricValue",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 23,
                    "options": {
                      "style": "decimal",
                      "useGrouping": false,
                      "maximumFractionDigits": 2,
                      "maximumSignificantDigits": 3
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "20",
            "name": "query - 0 - Copy - Copy - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "HDInsightHiveAndLLAPMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricName == \"SnapshotAvgTime\"\r\n|project ClusterName,MetricName, TimeGenerated, MetricValue\r\n| order by TimeGenerated desc\r\n| take 1",
              "size": 4,
              "showAnalytics": true,
              "timeContext": {
                "durationMs": 43200000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{LogAnalyticsWorkspaceName}"
              ],
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "MetricName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "MetricValue",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 23,
                    "options": {
                      "style": "decimal",
                      "useGrouping": false,
                      "maximumFractionDigits": 2,
                      "maximumSignificantDigits": 3
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "20",
            "name": "query - 0 - Copy - Copy - Copy - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "HDInsightHiveAndLLAPMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains \"Hadoop:service=hiveserver2\"\r\n| where MetricName contains \"AvgTime\"\r\n| summarize avg(MetricValue) by MetricName, bin(TimeGenerated, {TimeRange:grain})",
              "size": 0,
              "aggregation": 5,
              "showAnalytics": true,
              "title": "Operation Average Latencies",
              "timeContext": {
                "durationMs": 43200000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{LogAnalyticsWorkspaceName}"
              ],
              "visualization": "linechart",
              "chartSettings": {
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 23,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "name": "Operation Average Latencies"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "HDInsightHiveAndLLAPMetrics\r\n| where ClusterName == '{Cluster:label}'\r\n| where MetricNamespace contains \"Hadoop:service=hiveserver2\"\r\n| where MetricName contains \"NumOps\"\r\n| summarize avg(MetricValue) by MetricName, bin(TimeGenerated, {TimeRange:grain})",
              "size": 0,
              "aggregation": 5,
              "showAnalytics": true,
              "title": "Operation  Counts",
              "timeContext": {
                "durationMs": 43200000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{LogAnalyticsWorkspaceName}"
              ],
              "visualization": "linechart",
              "chartSettings": {
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "name": "Operation Counts"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "tab",
        "comparison": "isEqualTo",
        "value": "Hive"
      },
      "name": "Hive Server Interactive"
    }
  ],
  "fallbackResourceIds": [
    "Azure Monitor"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}